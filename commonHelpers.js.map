{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport axios from 'axios';\n\nconst modalLightboxGallery = new SimpleLightbox('.photo-container a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst searchForm = document.querySelector('.search-form');\nconst photoListEl = document.querySelector('.photo-list');\nconst loadMoreBtn = document.querySelector('[data-action=\"load-more\"]');\nconst loader = document.querySelector('.loader');\nconst loaderLoadMore = document.querySelector('.loader-load-more');\n\nconst hiddenClass = 'is-hidden';\n\nlet query = '';\nlet page = 1;\nlet maxPage = 0;\nconst pageSize = 40;\n\nsearchForm.addEventListener('submit', handleSearch);\n\nasync function handleSearch(event) {\n  event.preventDefault();\n\n  photoListEl.innerHTML = '';\n\n  loader.classList.remove(hiddenClass);\n\n  page = 1;\n\n  const form = event.currentTarget;\n  query = form.elements.query.value.trim();\n\n  if (!query) {\n    loader.classList.add(hiddenClass);\n    loadMoreBtn.classList.add(hiddenClass);\n\n    iziToast.show({\n      message: 'Please enter your request',\n      position: 'topRight',\n      color: 'yellow',\n    });\n    return;\n  }\n\n  try {\n    const { hits, totalHits } = await getPhotos(query);\n\n    maxPage = Math.ceil(totalHits / pageSize);\n\n    markupPhoto(hits, photoListEl);\n    if (hits.length > 0 && hits.length !== totalHits) {\n      loadMoreBtn.classList.remove(hiddenClass);\n      loadMoreBtn.addEventListener('click', handleLoadMore);\n    } else if (!hits.length) {\n      loadMoreBtn.classList.add(hiddenClass);\n\n      iziToast.show({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'center',\n        color: 'red',\n      });\n    } else {\n      loadMoreBtn.classList.add(hiddenClass);\n    }\n  } catch (error) {\n    console.log(error);\n  } finally {\n    loader.classList.add(hiddenClass);\n\n    form.reset();\n  }\n}\n\nasync function getPhotos(value, page = 1) {\n  const BASE_URL = 'https://pixabay.com/api';\n  const API_KEY = '41870399-9b44301246ceb98c07efd626a';\n  \n  try {\n    const response = await axios.get(`${BASE_URL}/`, {\n      params: {\n        key: API_KEY,\n        q: value,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        per_page: 15,\n        page,\n      },\n    });\n    return response.data;\n  } catch {\n    iziToast.error({\n      title: 'Error',\n      position: 'center',\n      color: 'red',\n      message: 'Sorry! Try later! Server not working',\n    });\n    console.error(error.message);\n  }\n}\n\nasync function handleLoadMore() {\n  page += 1;\n  loaderLoadMore.classList.remove(hiddenClass);\n  loadMoreBtn.classList.add(hiddenClass);\n\n  const getHeightImgCard = document\n    .querySelector('.gallery-item')\n    .getBoundingClientRect();\n\n  try {\n    const { hits } = await getPhotos(query, page);\n    markupPhoto(hits, photoListEl);\n  } catch (error) {\n    console.log(error);\n  } finally {\n    window.scrollBy({\n      top: getHeightImgCard.height * 2,\n      left: 0,\n      behavior: 'smooth',\n    });\n    loaderLoadMore.classList.add(hiddenClass);\n    loadMoreBtn.classList.remove(hiddenClass);\n    if (page === maxPage) {\n      loadMoreBtn.classList.add(hiddenClass);\n      loadMoreBtn.removeEventListener('click', handleLoadMore);\n      iziToast.show({\n        color: 'blue',\n        position: 'bottomCenter',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n  }\n}\n\nfunction markupPhoto(hits) {\n  const markup = hits\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `<li class=\"gallery-item\">\n  <a class=\"gallery-link\" href=\"${largeImageURL}\">\n    <img\n      class=\"gallery-image\"\n      src=\"${webformatURL}\"\n      alt=\"${tags}\"\n    />\n  </a><div class=\"gallery-descr\">\n   <p>Likes: <br><span>${likes}</span></p>\n   <p>Views: <br><span>${views}</span></p>\n   <p>Comment: <br><span>${comments}</span></p>\n   <p>Downloads: <br><span>${downloads}</span></p></div>\n</li>`\n    )\n    .join('');\n  photoListEl.insertAdjacentHTML('beforeend', markup);\n  modalLightboxGallery.refresh();\n}"],"names":["modalLightboxGallery","SimpleLightbox","searchForm","photoListEl","loadMoreBtn","loader","loaderLoadMore","hiddenClass","query","page","maxPage","pageSize","handleSearch","event","form","iziToast","hits","totalHits","getPhotos","markupPhoto","handleLoadMore","error","value","BASE_URL","API_KEY","axios","getHeightImgCard","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads"],"mappings":"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"}